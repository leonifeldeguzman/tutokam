<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TutoKam - Study Focus Assistant</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        background: #e8e4f3;
        min-height: 100vh;
        padding: 30px 20px;
        color: #333;
        position: relative;
        overflow-x: hidden;
      }

      /* Decorative leaves */
      .leaf-left, .leaf-right {
        position: fixed;
        bottom: 0;
        width: 200px;
        height: 200px;
        z-index: 1;
      }

      .leaf-left {
        left: 0;
        background: #10b981;
        border-radius: 0 100% 0 0;
      }

      .leaf-right {
        right: 0;
        background: #10b981;
        border-radius: 100% 0 0 0;
      }

      .header {
        max-width: 1400px;
        margin: 0 auto 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        z-index: 10;
      }

      .logo {
        font-size: 36px;
        font-weight: bold;
        color: #1a1a1a;
      }

      .logo span {
        color: #f97316;
      }

      .start-btn {
        background-color: white;
        color: #f97316;
        border: 2px solid #f97316;
        padding: 12px 32px;
        font-size: 16px;
        font-weight: 600;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .start-btn:hover {
        background-color: #f97316;
        color: white;
      }

      .calibration-message {
        background-color: #10b981;
        color: white;
        border-radius: 12px;
        padding: 15px;
        margin: 0 auto 20px;
        max-width: 600px;
        text-align: center;
        display: none;
        position: relative;
        z-index: 10;
      }

      .container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 25px;
        max-width: 1400px;
        margin: 0 auto;
        position: relative;
        z-index: 10;
      }

      .card {
        background: #1e1548;
        border-radius: 20px;
        padding: 30px;
        color: white;
      }

      .card h3 {
        font-size: 20px;
        margin-bottom: 20px;
        font-weight: 600;
      }

      /* Video Container */
      .video-container {
        display: flex;
        flex-direction: column;
        gap: 25px;
      }

      canvas {
        width: 100%;
        height: auto;
        border-radius: 12px;
        background-color: white;
      }

      /* Right Column */
      .right-column {
        display: flex;
        flex-direction: column;
        gap: 25px;
      }

      /* Focus Score Card */
      .focus-score-card {
        background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        border-radius: 20px;
        padding: 40px 30px;
        text-align: center;
      }

      .focus-score-title {
        font-size: 18px;
        color: white;
        margin-bottom: 15px;
        font-weight: 600;
      }

      .focus-score {
        font-size: 64px;
        color:white;
        font-weight: bold;
        margin-bottom: 5px;
        line-height: 1;
      }

      .score-label {
        font-size: 18px;
        color: white;
        opacity: 0.9;
        margin-bottom: 20px;
      }

      .progress-bar {
        height: 12px;
        background-color: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #f97316, #ea580c);
        width: 35%;
        transition: width 0.5s ease;
        border-radius: 10px;
      }

      /* Behavior Tracking */
      .behavior-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }

      .stat-box {
        background: white;
        border-radius: 12px;
        padding: 20px 15px;
        text-align: center;
      }

      .stat-value {
        font-size: 32px;
        font-weight: bold;
        margin-bottom: 8px;
        color: #1a1a1a;
      }

      .stat-label {
        font-size: 13px;
        color: #666;
        font-weight: 500;
      }

      /* Movement Status */
      .prediction-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
      }

      .prediction-item {
        background: white;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        transition: all 0.3s ease;
        color: #1a1a1a;
      }

      .prediction-item.active {
        background: #f97316;
        color: white;
        font-weight: bold;
      }

      .prediction-label {
        font-size: 14px;
        margin-bottom: 5px;
        font-weight: 600;
      }

      .prediction-value {
        font-size: 16px;
        font-weight: bold;
      }

      /* Alert Box */
      .alert-box {
        background: rgba(251, 191, 36, 0.2);
        border: 2px solid #fbbf24;
        border-radius: 12px;
        padding: 15px;
        display: block;
        font-size: 14px;
        line-height: 1.5;
      }

      .alert-box.warning {
        background: rgba(251, 191, 36, 0.3);
        border-color: #f59e0b;
      }

      .alert-box.alert {
        background: rgba(239, 68, 68, 0.3);
        border-color: #ef4444;
      }

      .gesture-info {
        background: rgba(59, 130, 246, 0.2);
        border: 2px solid #3b82f6;
        border-radius: 12px;
        padding: 15px;
        margin-top: 10px;
        display: none;
        font-size: 14px;
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .container {
          grid-template-columns: 1fr;
        }

        .behavior-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (max-width: 768px) {
        body {
          padding: 20px 15px;
        }

        .header {
          flex-direction: column;
          gap: 20px;
        }

        .card {
          padding: 20px;
        }

        .behavior-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .prediction-container {
          grid-template-columns: repeat(2, 1fr);
        }

        .focus-score-card {
          padding: 30px 20px;
        }

        .leaf-left, .leaf-right {
          width: 150px;
          height: 150px;
        }
      }

      @media (max-width: 480px) {
        .logo {
          font-size: 24px;
        }

        .start-btn {
          padding: 10px 24px;
          font-size: 14px;
        }

        .behavior-grid {
          grid-template-columns: 1fr 1fr;
          gap: 10px;
        }

        .stat-box {
          padding: 15px 10px;
        }

        .stat-value {
          font-size: 24px;
        }

        .leaf-left, .leaf-right {
          width: 100px;
          height: 100px;
        }
      }

      .footer {
        text-align: center;
        margin-top: 30px;
        color: #666;
        font-size: 0.9em;
        position: relative;
        z-index: 10;
      }
    </style>
  </head>
  <body>
    <!-- Decorative leaves -->
    <div class="leaf-left"></div>
    <div class="leaf-right"></div>

    <div class="header">
      <div class="logo">Tut<span>o</span>Kam</div>
      <button type="button" class="start-btn" onclick="init()">Start Monitoring</button>
    </div>

    <div id="calibrationMessage" class="calibration-message">
      <strong>Calibrating...</strong> Please sit in your normal study position for 10 seconds.
    </div>

   <div class="container">
  <!-- LEFT COLUMN -->
  <div class="video-container">
    <div class="card">
      <h3>Live Detection Feed</h3>
      <canvas id="canvas"></canvas>
    </div>

    <!-- FOCUS SCORE MOVED HERE -->
    <div class="focus-score-card">
      <div class="focus-score-title">Your Focus Progress</div>
      <div class="focus-score" id="focusScore">100</div>
      <div class="score-label">Score</div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>
  </div>

  <!-- RIGHT COLUMN -->
  <div class="right-column">

    <!-- MOVEMENT & STATUS MOVED HERE -->
    <div class="card">
      <h3>Movement & Status</h3>
      <div id="label-container" class="prediction-container">
        <div class="prediction-item">
          <div class="prediction-label">Default</div>
          <div class="prediction-value">0%</div>
        </div>
        <div class="prediction-item">
          <div class="prediction-label">Raise Hand</div>
          <div class="prediction-value">0%</div>
        </div>
        <div class="prediction-item">
          <div class="prediction-label">Looking Away</div>
          <div class="prediction-value">0%</div>
        </div>
        <div class="prediction-item">
          <div class="prediction-label">Looking Down</div>
          <div class="prediction-value">0%</div>
        </div>
        <div class="prediction-item active">
          <div class="prediction-label">Leaning on Hand</div>
          <div class="prediction-value">100%</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Behavior Tracking</h3>
      <div class="behavior-grid">
        <div class="stat-box">
          <div class="stat-value" id="leaningTime">1s</div>
          <div class="stat-label">Learning Duration</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="lookingAwayCount">9</div>
          <div class="stat-label">Looking Away Count</div>
        </div>
        <div class="stat-box">
          <div class="stat-value"><span id="focusStreak">15</span>m</div>
          <div class="stat-label">Focus Streak</div>
        </div>
        <div class="stat-box">
          <div class="stat-value"><span id="sessionTime">0</span>m</div>
          <div class="stat-label">Session Time</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Alert & Assistance</h3>
      <div id="alertBox" class="alert-box alert">
        <strong>Important:</strong> Your focus is dropping significantly. Consider taking a short break.
      </div>
      <div id="gestureInfo" class="gesture-info">
        <strong>Raised Hand Detected:</strong> Would you like to ask a question?
      </div>
    </div>

  </div>
</div>

    <div class="footer">
      <p>Study Focus Assistant &copy; 2024 | Uses TensorFlow.js and Teachable Machine</p>
    </div>

    <audio id="wakeUpAudio">
      <source src="wakeupalarm.mp3" type="audio/mpeg" />
    </audio>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/pose@0.8/dist/teachablemachine-pose.min.js"></script>
    <script src="monitoring.js"></script>
  </body>
</html>